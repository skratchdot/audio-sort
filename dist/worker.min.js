!function(n){"use strict";var a={},i=[],h=[],r="",o={play:[],mark:[],swap:[],compare:[],highlight:[]},u=0,l=0,f=function(n){var t="object"==typeof n,e=parseInt(1e7*Math.random(),10);return{id:t?n.id:e+"_"+n,value:t?n.value:n,play:t&&n.play,mark:t&&n.mark,swap:t&&n.swap,justSwapped:t&&n.justSwapped,compare:t&&n.compare,highlight:t&&n.highlight}},g=function(n){(0===h.length||o.hasOwnProperty(n)&&o[n].length)&&c()},c=function(){for(var n,t=[],e=0;e<i.length;e++)n=f(i[e]),0<=o.swap.indexOf(n.id)&&(n.justSwapped=!0),0<=o.highlight.indexOf(n.id)&&(n.highlight=!0),t.push(n);h.push({arr:t,compareCount:u,swapCount:l}),o.play=[],o.mark=[],o.swap=[],o.compare=[]},p=function(n){for(var t=0;t<i.length;t++)if(i[t].id===n.id)return t;return-1},s=function(n){for(var t,e=[],r=0;r<n.length;r++)"number"==typeof(t=n[r])&&(t=a.get(t)),e.push(t);return e},e=function(n,t){n=v("compare",[n,t]);return u++,h[h.length-1].compareCount=u,n},v=function(n,t){var e,r,a,i,u=s(t);for(g(n),e=h.length-1,r=h[e].arr.length,a=0;a<u.length;a++)0<=(i=p(u[a]))&&i<r&&(h[e].arr[i][n]=!0,o.hasOwnProperty(n)&&o[n].push(h[e].arr[i].id));return u};a.getFrames=function(){return h},a.init=function(n,t){var e;for(i=[],h=[],r=t,e=l=u=0;e<n.length;e++)i.push(f(n[e]))},a.end=function(n){var t,e;if(r!==n)return[];for(0===h.length&&c(),e=h[h.length-1].arr,t=0;t<i.length;t++)if(i[t].id!==e)return c(),h;return h},a.length=function(){return i.length},a.size=a.length,a.lt=function(n,t){n=e(n,t);return n[0].value<n[1].value},a.lte=function(n,t){n=e(n,t);return n[0].value<=n[1].value},a.gt=function(n,t){n=e(n,t);return n[0].value>n[1].value},a.gte=function(n,t){n=e(n,t);return n[0].value>=n[1].value},a.eq=function(n,t){n=e(n,t);return n[0].value===n[1].value},a.neq=function(n,t){n=e(n,t);return n[0].value!==n[1].value},a.play=function(){v("play",arguments)},a.mark=function(){v("mark",arguments)},a.clearHighlight=function(){o.highlight=[]},a.highlight=function(){a.clearHighlight(),v("highlight",arguments)},a.get=function(n){return f(i[n])},a.swap=function(n,t){var n=v("swap",[n,t]),t=p(n[0]),n=p(n[1]),e=i[t],r=i[n];i[t]=r,i[n]=e,l++,h[h.length-1].swapCount=l},n.AS=a}(this),function(a){"use strict";a.onmessage=function(n){var t=Function,e={},r=(new Date).getTime();e.key=n.data.key||"",e.fn=n.data.fn||"function () {\n}",e.arr=n.data.arr||[],n=e.fn.split("\n"),e.fn=n.splice(1,n.length-2).join("\n"),e.fn=new t(e.fn),AS.init(e.arr,r),e.fn(),n=AS.end(r),a.postMessage({key:e.key,frames:n,fn:e.fn.toString()})}}(this);