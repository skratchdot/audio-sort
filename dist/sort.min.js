!function(e){"use strict";e.fn=e.fn||{datagen:{}}}(this),function(i){"use strict";i.fn.datagen.almostSorted=function(e){for(var t,a=i.fn.datagen.sorted(e),n=[],r=a.length,o=0;o<r;o++)t=i.fn.random(o,Math.min(o+2,r-1)),n.indexOf(o)<0&&n.indexOf(t)<0&&(n.push(o),n.push(t),i.fn.swap(a,o,t));return a}}(this),function(n){"use strict";n.fn.datagen.fewUnique=function(e){for(var t=[],a=0;a<e;a++)t.push(e-1-Math.floor(e/4)*(a%4));return n.fn.shuffle(t)}}(this),function(e){"use strict";e.fn.datagen.randomDupes=function(e){for(var t=[],a=0;a<e;a++)t.push(Math.floor(Math.random()*e));return t}}(this),function(t){"use strict";t.fn.datagen.randomUnique=function(e){return t.fn.shuffle(t.fn.datagen.sorted(e))}}(this),function(t){"use strict";t.fn.datagen.reverse=function(e){return t.fn.datagen.sorted(e).reverse()}}(this),function(e){"use strict";e.fn.datagen.sorted=function(e){for(var t=[],a=0;a<e;a++)t.push(a);return t}}(this),function(e){"use strict";e.fn.random=function(e,t){return Math.floor(Math.random()*(t-e+1))+e}}(this),function(n){"use strict";n.fn.shuffle=function(e){var t,a=e.length;if(0!==a)for(;--a;)t=Math.floor(Math.random()*(a+1)),e=n.fn.swap(e,a,t);return e}}(this),function(e){"use strict";e.fn.swap=function(e,t,a){var n,r=e.length;return(t=parseInt(t,10)||0)!==(a=parseInt(a,10)||0)&&0<=t&&0<=a&&t<r&&a<r&&(r=e[t],n=e[a],e[t]=n,e[a]=r),e}}(this),function(e){"use strict";e.sort=e.sort||{}}(this),function(e){"use strict";e.sort.bubble=function(){var e,t,a=AS.length();do{for(t=!1,e=0;e<a-1;e++)AS.play(e),AS.mark(e),AS.lt(e+1,e)&&(AS.swap(e+1,e),t=!0)}while(a--,t);AS.play(e)},e.sort.bubble.display="Bubble",e.sort.bubble.stable=!0,e.sort.bubble.best="n",e.sort.bubble.average="n^2",e.sort.bubble.worst="n^2",e.sort.bubble.memory="1",e.sort.bubble.method="exchanging"}(this),function(e){"use strict";e.sort.heap=function(){function o(e,t){var a=2*(e+1)-1,n=2*(e+1),r=e;AS.play(e),AS.mark(e),a<t&&(AS.play(a),AS.mark(a),AS.gt(a,r)&&(r=a)),n<t&&(AS.play(n),AS.mark(n),AS.gt(n,r)&&(r=n)),r!==e&&(AS.swap(e,r),o(r,t))}for(var e=AS.length(),t=function(e){return Math.floor((e+1)/2)-1}(e-1);0<=t;t--)AS.highlight(t),o(t,e);AS.clearHighlight();for(var a=AS.length();1<a;a--)AS.mark(0),AS.play(0),AS.swap(0,a-1),AS.highlight(a-1),o(0,a-1)},e.sort.heap.display="Heap",e.sort.heap.stable=!1,e.sort.heap.best="n",e.sort.heap.worst="nlogn",e.sort.heap.average="nlogn",e.sort.heap.memory="1",e.sort.heap.method="heap"}(this),function(e){"use strict";e.sort.insertion=function(){for(var e,t,a,n=AS.length(),r=0;r<n;r++)for(t=AS.get(r),e=r-1;-1<e;e--)a=AS.get(e),AS.play(e),AS.gt(a,t)&&AS.swap(e,e+1)},e.sort.insertion.display="Insertion",e.sort.insertion.stable=!0,e.sort.insertion.best="n",e.sort.insertion.average="n^2",e.sort.insertion.worst="n^2",e.sort.insertion.memory="1",e.sort.insertion.method="insertion"}(this),function(e){"use strict";e.sort.quick=function(){var n=function(e,t){var a=Math.floor((t+e)/2),n=AS.get(a),r=e,o=t;for(AS.clearHighlight(),AS.play(r,o),AS.mark(r,o),AS.highlight(r,o,a);r<=o;){for(;AS.lt(AS.get(r),n);)AS.play(r,o),AS.mark(r,o),r++;for(;AS.gt(AS.get(o),n);)AS.play(r,o),AS.mark(r,o),o--;r<=o&&(AS.play(r,o),AS.mark(r,o),AS.swap(r,o),r++,o--)}return AS.clearHighlight(),r},r=function(e,t){var a=AS.length();1<a&&(e="number"!=typeof e?0:e,t="number"!=typeof t?a-1:t,AS.mark(e,t),e<(a=n(e,t))-1&&r(e,a-1),a<t&&r(a,t))};r()},e.sort.quick.display="Quick",e.sort.quick.stable=!0,e.sort.quick.best="n",e.sort.quick.average="n^2",e.sort.quick.worst="n^2",e.sort.quick.memory="1",e.sort.quick.method="exchanging"}(this),function(e){"use strict";e.sort.selection=function(){for(var e,t,a=AS.length(),n=0;n<a;n++){for(t=(e=n)+1;t<a;t++)AS.play(t),AS.mark(n,t),AS.lt(t,e)&&(e=t);n!==e&&AS.swap(n,e)}},e.sort.selection.display="Selection",e.sort.selection.stable=!1,e.sort.selection.best="n^2",e.sort.selection.average="n^2",e.sort.selection.worst="n^2",e.sort.selection.memory="1",e.sort.selection.method="selection"}(this),function(e){"use strict";e.visualization=e.visualization||{}}(this),function(e){"use strict";var c,p=-1,d=-1,m=-1,f=!1;e.visualization.bar=function(e){var s,a,i,l,n,t={},r=function(e){s=e.data,i=e.svg,(a=e.$svg).removeAttr("preserveAspectRatio"),a.removeAttr("viewBox"),l=e.hasMarkers,n=e.onClick},o=function(e,t,a){var n,r,o;l&&(n=i.selectAll("circle."+a).data(e.arr),r=e.arr.length,n.enter().append("circle"),o=100/(4*Math.max(r,20)),n.attr("cy",100-10*t+"%").attr("cx",function(e,t){return t/r*100+100/(2*r)+"%"}).attr("r",function(){return o+"%"}).attr("class",a).attr("style",function(e){return e[a]?"":"display:none"}),n.exit().remove())},u=function(e){var t=$(e.currentTarget),a=t.parent(),n=0,r=0,o=a.offset(),i=e.pageX-o.left,e=e.pageY-o.top;return i=(i=(i-=parseInt(a.css("border-left-width"),10))-parseInt(a.css("margin-left"),10))-parseInt(a.css("padding-left"),10),e=(e=(e-=parseInt(a.css("border-top-width"),10))-parseInt(a.css("margin-top"),10))-parseInt(a.css("padding-top"),10),o=t.parent().width(),a=t.parent().height(),0<s.length&&(r=(n=s[0].arr.length)-1),t=Math.floor(i/o*n),i=Math.floor(e/a*n),t=isFinite(t)?t:0,i=isFinite(i)?i:0,{index:Math.min(r,t),value:r-Math.min(r,i)}};return t.onMouseMove=function(e){var t,e=u(e);p!==e.index&&(p=e.index,(t=a.find("rect")).attr("opacity",1),t.eq(p).attr("opacity",.5)),c=e.value,!f||p===d&&c===m||n(d=p,m=c)},t.onMouseOut=function(){p=-1,a.find("rect").attr("opacity",1)},t.onMouseDown=function(e){var t=u(e);e.preventDefault(),f=!0,d=t.index,m=t.value,n(d,m)},t.onMouseUp=function(){f=!1,m=d=-1},t.draw=function(e){var t,a;return 0<s.length&&(t=s[e],e=i.selectAll("rect").data(t.arr),a=t.arr.length,e.enter().append("rect"),e.attr("width",function(){return 100/a+"%"}).attr("height",function(e){return 100/a*(e.value+1)+"%"}).attr("x",function(e,t){return t/a*100+"%"}).attr("y",function(e){return 100-100/a*(e.value+1)+"%"}).attr("class",function(e){return e.play?"play":""}),e.exit().remove(),o(t,1,"highlight"),o(t,2,"justSwapped"),o(t,3,"swap"),o(t,4,"compare"),o(t,5,"mark")),t},r(e),t}}(this),function(e){"use strict";e.visualization.flat=function(e){var t,n,r,a={},u=[],c=[],p=0,d=0,o=function(e){u=e.data,n=e.svg,t=e.$svg,u.length?(p=u[0].arr.length,d=u.length,i()):(d=p=0,c=[]),t.empty(),n.attr("viewBox","0 0 0 0"),n.attr("preserveAspectRatio","none"),n.attr("viewBox","0 0 "+(d-1)+" "+p),t.empty(),s()},i=function(){var e,t,a,n,r,o,i,s,l=[];if(c=[],u.length){for(i=u[u.length-1].arr,s=Math.floor(p/2),e=0;e<p;e++)a=i[e].id,l.push(a),c[e]={id:a,dataColor:d3.rgb("steelblue").darker((e-s)/s).toString(),playColor:d3.rgb("#c80000").darker((e-s)/s).toString(),playIndexes:[],lineData:[]};for(e=0;e<d;e++)for(n=u[e].arr,t=0;t<n.length;t++)r=n[t],o=l.indexOf(r.id),c[o].lineData.push({x:e,y:t+.5}),r.play&&c[o].playIndexes.push(e);c.reverse()}},s=function(t){var a=d3.svg.line().interpolate("linear").x(function(e){return e.x}).y(function(e){return e.y});(r=n.selectAll(".line").data(c)).enter().append("path"),r.attr("class","line").attr("data-id",function(e){return e.id}).attr("stroke",function(e){return 0<=e.playIndexes.indexOf(t)?e.playColor:e.dataColor}).attr("fill","none").attr("stroke-width",.5).attr("d",function(e){return a(e.lineData)}),r.exit().remove()};return a.draw=function(t){if(r.attr("stroke",function(e){return 0<=e.playIndexes.indexOf(t)?e.playColor:e.dataColor}),0<u.length)return u[t]},o(e),a}}(this),function(e){"use strict";var r={},o=[],s=[],n="",l={play:[],mark:[],swap:[],compare:[],highlight:[]},i=0,u=0,c=function(e){var t="object"==typeof e,a=parseInt(1e7*Math.random(),10);return{id:t?e.id:a+"_"+e,value:t?e.value:e,play:t&&e.play,mark:t&&e.mark,swap:t&&e.swap,justSwapped:t&&e.justSwapped,compare:t&&e.compare,highlight:t&&e.highlight}},p=function(e){(0===s.length||l.hasOwnProperty(e)&&l[e].length)&&d()},d=function(){for(var e,t=[],a=0;a<o.length;a++)e=c(o[a]),0<=l.swap.indexOf(e.id)&&(e.justSwapped=!0),0<=l.highlight.indexOf(e.id)&&(e.highlight=!0),t.push(e);s.push({arr:t,compareCount:i,swapCount:u}),l.play=[],l.mark=[],l.swap=[],l.compare=[]},m=function(e){for(var t=0;t<o.length;t++)if(o[t].id===e.id)return t;return-1},f=function(e){for(var t,a=[],n=0;n<e.length;n++)"number"==typeof(t=e[n])&&(t=r.get(t)),a.push(t);return a},a=function(e,t){e=v("compare",[e,t]);return i++,s[s.length-1].compareCount=i,e},v=function(e,t){var a,n,r,o,i=f(t);for(p(e),a=s.length-1,n=s[a].arr.length,r=0;r<i.length;r++)0<=(o=m(i[r]))&&o<n&&(s[a].arr[o][e]=!0,l.hasOwnProperty(e)&&l[e].push(s[a].arr[o].id));return i};r.getFrames=function(){return s},r.init=function(e,t){var a;for(o=[],s=[],n=t,a=u=i=0;a<e.length;a++)o.push(c(e[a]))},r.end=function(e){var t,a;if(n!==e)return[];for(0===s.length&&d(),a=s[s.length-1].arr,t=0;t<o.length;t++)if(o[t].id!==a)return d(),s;return s},r.length=function(){return o.length},r.size=r.length,r.lt=function(e,t){e=a(e,t);return e[0].value<e[1].value},r.lte=function(e,t){e=a(e,t);return e[0].value<=e[1].value},r.gt=function(e,t){e=a(e,t);return e[0].value>e[1].value},r.gte=function(e,t){e=a(e,t);return e[0].value>=e[1].value},r.eq=function(e,t){e=a(e,t);return e[0].value===e[1].value},r.neq=function(e,t){e=a(e,t);return e[0].value!==e[1].value},r.play=function(){v("play",arguments)},r.mark=function(){v("mark",arguments)},r.clearHighlight=function(){l.highlight=[]},r.highlight=function(){r.clearHighlight(),v("highlight",arguments)},r.get=function(e){return c(o[e])},r.swap=function(e,t){var e=v("swap",[e,t]),t=m(e[0]),e=m(e[1]),a=o[t],n=o[e];o[t]=n,o[e]=a,u++,s[s.length-1].swapCount=u},e.AS=r}(this),function(e){"use strict";e.A=e.A||{}}(this),function(e){"use strict";var t={},o=function(e,t,a,n){return e[n%t]+Math.floor(n/t)*a};t.getMidiNumber=function(e){var t=sc.ScaleInfo.at(A.Sort.getSelected("scale")),a=t.pitchesPerOctave(),t=t.degrees(),n=t.length,r=Math.floor(A.Sort.getSelected("dataSize")/2),e=o(t,n,a,e),t=o(t,n,a,r);return e+A.Sort.getSelected("centerNote")-t},t.createSlider=function(e,t,a){var n=$(e),r=$('<div class="audio-sort-slider"></div>');return n.empty(),r.appendTo(n),(n=r.slider({value:t.value,min:t.min,max:t.max,step:t.step,orientation:"horizontal",selection:"none",tooltip:"hide"})).on("slide",a),n.on("slideStop",a),$(e+" .slider").width("100%"),n},e.A.Helper=t}(this),function(e){"use strict";var t={populateChannels:function(e){var t,a,e=$(e),n="";for(e.empty(),t=0;t<16;t++)a=$("<option></option>").val(t).text(t),0===t&&a.attr("selected","selected"),n+=a.wrap("<div />").parent().html();e.append(n)},populateInstruments:function(e){var t,a,n,r="",o=$(e);for(o.empty(),t=0;t<A.instruments.length;t++)r!==(n=A.instruments[t]).group&&(r=n.group,a&&o.append(a),a=$("<optgroup></optgroup>").attr("label",r)),n=$("<option></option>").val(t).text(t+": "+n.name),0===t&&n.attr("selected","selected"),a.append(n);o.append(a)}};e.A.MidiExport=t}(this),function(D){"use strict";D.A.Player={},D.A.Player.create=function(t,e){var r,o,i,s,n,a,l,u,c,p,d,m,f,v,g,h,y,S,w,b,k,x,P,C,M={},O="rgba(255, 255, 255, 0)",E="bar",B=function(){r=(e=e||{}).isLooping||!1,o=e.isPlaying||!1,i=e.isReverse||!1,n=e.hasMarkers||!1,a=e.allowHover||!1,l=e.allowClick||!1,"function"!=typeof(u=e.onClick)&&(u=$.noop),s=0,c=$(t||null),m=c.find(".compare-current"),f=c.find(".compare-max"),v=c.find(".swap-current"),g=c.find(".swap-max"),h=c.find(".position-current"),y=c.find(".position-max"),p=c.find("svg"),S=d3.select("#"+p.attr("id")),C=e.onPlayerButtonClickCallback||null,M.refreshWaveGenerator(),b=timbre("interval",{interval:A.Sort.getTempoString()},z),c.find(".player-buttons").on("click",".btn",L),a&&(p.on("mousemove",function(e){P.onMouseMove&&P.onMouseMove(e)}),p.on("mouseout",function(e){P.onMouseOut&&P.onMouseOut(e)})),l&&(p.on("mousedown",function(e){P.onMouseDown&&P.onMouseDown(e)}),$("body").on("mouseup",function(e){P.onMouseUp&&P.onMouseUp(e)}))},T=function(e){e=e.getContext("2d");e.clearRect(0,0,e.canvas.width,e.canvas.height)},G=function(){var e,t=w.length,a=t-1;I(),(e=P.draw(s))&&(m.length&&m.text(e.compareCount),f.length&&f.text(0<a?w[a].compareCount:0),v.length&&v.text(e.swapCount),g.length&&g.text(0<a?w[a].swapCount:0),h.length&&h.text(s+1),y.length&&y.text(t))},H=function(){d.length&&d.slider("setValue",s)},I=function(){s=Math.min(s,w.length-1),s=Math.max(s,0)},z=function(){var e,t,a,n;if(o){if(I(),H(),0<w.length){for(e=w[s],n=A.Sort.getSelected("audioType"),t=0;t<e.arr.length;t++)(a=e.arr[t]).play&&0<=(a=A.Helper.getMidiNumber(a.value))&&a<128&&("waveform"===n?x.noteOn(a,64):"soundfont"===n&&timbre.soundfont.play(a,!1,{mul:1.5*A.Sort.getSelected("volume")}));G()}s=i?s-1:s+1,!r&&(s<0||s>=w.length)&&M.stop(),r&&s<0?s=w.length-1:r&&s>=w.length&&(s=0)}else M.stop()},L=function(){var e=$(this),t=e.data("action");"stop"===t?M.stop():"play"===t?M.play():"reverse"===t?M.play(!0):"goToFirst"===t?M.goToFirst():"goToLast"===t?M.goToLast():"loop"===t&&((r=!e.hasClass("active"))?e.addClass("active"):e.removeClass("active")),H(),"function"==typeof C&&C({item:e,action:t})},F=function(e){s=parseInt(e.value,10),I(),G()};return M.setData=function(e){w=e,d=A.Helper.createSlider(t+" .position-container",{value:0,min:0,max:w.length-1,step:1},F),M.setVisualization(E,!0)},M.setVisualization=function(e,t){var a=!1;D.visualization.hasOwnProperty(e)&&E!==e&&(E=e,a=!0),a&&p.empty(),(a||t)&&(P=D.visualization[E]({data:w,svg:S,$svg:p,hasMarkers:n,onClick:u}),G())},M.setTempo=function(e){b.set({interval:e})},M.setVolume=function(e){x.set({mul:e})},M.play=function(e){b.stop(),(o=!0)===e?(i=!0,s<=0&&(s=w.length-1)):(i=!1,s>=w.length-1&&(s=0)),i=!0===e,"waveform"===A.Sort.getSelected("audioType")&&x.play(),b.start()},M.stop=function(){o=!1,b.stop()},M.isPlaying=function(){return o},M.goToFirst=function(){s=0,I(),G()},M.goToLast=function(){s=w.length-1,I(),G()},M.getMidiBytes=function(e,t,a){var n,r,o,i,s,l=0,u=new Midi.File,c=new Midi.Track;for(c.setTempo(e),c.setInstrument(t,a),u.addTrack(c),n=0;n<w.length;n++){for(o=w[n],s=[],l+=64,r=0;r<o.arr.length;r++)(i=o.arr[r]).play&&0<=(i=A.Helper.getMidiNumber(i.value))&&i<128&&s.push(i);for(r=0;r<s.length;r++)0===r?c.noteOn(t,s[r],64):c.noteOn(t,s[r]);for(r=0;r<s.length;r++)c.noteOff(t,s[r])}return c.addEvent(new Midi.MetaEvent({type:Midi.MetaEvent.COPYRIGHT,data:"Audio Sort <skratchdot.com>",time:l+1024})),u.toBytes()},M.refreshWaveGenerator=function(){var e=A.Sort.getSelectedWaveformInfo();$.each([k,x],function(e,a){$.each(["pause","removeAllListeners"],function(e,t){a&&"function"==typeof a[t]&&a[t]()})}),k=timbre("adshr",{a:e.a,d:e.d,s:e.s,h:e.h,r:e.r}),x=timbre(e.gen,{env:k,mul:A.Sort.getSelected("volume")*e.mul,poly:e.poly||10}).on("ended",function(){o||this.pause()}),"OscGen"===e.gen&&x.set("osc",timbre(A.Sort.getSelected("waveform"))),o&&"waveform"===A.Sort.getSelected("audioType")&&x.play()},M.drawEnvelopeCanvas=function(){var e=$("#waveform-adshr-canvas").get(0);T(e),k&&"function"==typeof k.plot&&k.plot({target:e,background:O})},M.drawWaveformCanvases=function(){var e=$("#waveform-canvas").get(0);M.drawEnvelopeCanvas(),T(e),x&&x.osc&&x.osc.plot({target:e,background:O})},B(),M}}(this),function(i){"use strict";var o,a,n,r={},s=Function,t={value:.25,min:0,max:1,step:.01},l={value:90,min:20,max:300,step:1},u={value:69,min:0,max:127,step:1},F={value:"chromatic"},D={value:"bubble"},c={value:12,min:4,max:48,step:1},R={value:"waveform"},j={value:"string"},W={value:0},p={volume:t.value,tempo:l.value,centerNote:u.value,scale:F.value,sort:D.value,dataSize:c.value,audioType:R.value,waveform:j.value,soundfont:W.value},d={string:{gen:"PluckGen",poly:10,mul:1,a:50,d:300,s:.5,h:500,r:2500},sin:{gen:"OscGen",poly:10,mul:1,a:50,d:300,s:.5,h:200,r:300},cos:{gen:"OscGen",poly:10,mul:1,a:50,d:300,s:.5,h:200,r:300},pulse:{gen:"OscGen",poly:10,mul:.25,a:50,d:300,s:.5,h:200,r:300},tri:{gen:"OscGen",poly:10,mul:1,a:50,d:300,s:.5,h:200,r:300},saw:{gen:"OscGen",poly:10,mul:.25,a:50,d:300,s:.5,h:200,r:300},fami:{gen:"OscGen",poly:10,mul:1,a:50,d:300,s:.5,h:200,r:300},konami:{gen:"OscGen",poly:10,mul:.4,a:50,d:300,s:.5,h:200,r:300}},m={},f={base:null,sort:null},v=!1,g={},h=[],y=[],S=null,e=null,w="dist/worker.min.js",b=function(e){var t,a,n,r,o;if(i.hasOwnProperty("sort"))for(r in(t=$(e)).empty(),i.sort)i.sort.hasOwnProperty(r)&&(o=i.sort[r],a=$("<li></li>"),(n=$('<a href="javascript:void(0);"></a>')).attr("data-sort",r),n.text(o.display),a.append(n),t.append(a))},q=function(){var t="";$.each(d,function(e){t+=$("<button />").addClass("btn btn-mini"+(e===p.waveform?" active":"")).attr("type","button").attr("data-waveform",e).text(e).wrap("<div />").parent().html()}),$("#waveform .btn-group").html(t)},V=function(){var e=$(this);p.waveform=e.attr("data-waveform"),te(),P("#audio-type-display","waveform: "+p.waveform),f.base.refreshWaveGenerator(),f.sort.refreshWaveGenerator(),f.base.drawWaveformCanvases()},N=function(e){for(var t=[],a=0;a<h.length;a++)t.push({value:h[a],play:a===e,mark:!1,swap:!1,justSwapped:!1,compare:!1,highlight:!1});return t},k=function(){for(var e=[],t=0;t<h.length;t++)e.push({arr:N(t),compareCount:0,swapCount:0});return e},X=function(){$('#sort-player .btn[data-action="play"]').click()},x=function(e){var t=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],a=t.length,n=Math.floor(e/a)-1,t=t[e%a];return"("+t.charAt(0)+n+t.charAt(1)+") "+e},P=function(e,t,a){g.hasOwnProperty(e)||(g[e]=$(e)),"function"==typeof a&&(t=a(t)),g[e].text(t)},_=function(){var e=$(this),t=$("#settings li[data-audio-type]"),a=$("#audio-type-tab-link"),n=e.attr("data-audio-type"),e=e.text(),r=p.audioType=n;"waveform"===p.audioType?(r+=": "+p.waveform,f.base.refreshWaveGenerator(),f.sort.refreshWaveGenerator()):"soundfont"===p.audioType&&(r=$("#soundfont-options li.active").text()),P("#audio-type-display",r),a.text(e.toLowerCase()+" settings"),t.removeClass("hidden"),t.filter('[data-audio-type!="'+n+'"]').addClass("hidden"),H()},U=function(){$("#settings li[data-audio-type]:visible a").click()},C=function(e,t,a,n){a&&(p[e]=a.value),P(t,p[e],n)},Y=function(e){C("volume","#volume-display",e,function(e){return e.toFixed(2)}),e=d[p.waveform].mul*p.volume,f.base.setVolume(e),f.sort.setVolume(e)},K=function(e){var t=r.getTempoString();C("tempo","#tempo-display",e),f.base.setTempo(t),f.sort.setTempo(t)},Q=function(e){C("centerNote","#center-note-display",e,x),H()},Z=function(e){C("dataSize","#data-size-display",e),B(!1),L()},M=function(e){var t=$(e.target).parents("[data-adshr]:first").attr("data-adshr");d[p.waveform][t]="s"===t?parseFloat(e.value.toFixed(2)):e.value,O(),f.base.refreshWaveGenerator(),f.sort.refreshWaveGenerator(),f.base.drawEnvelopeCanvas()},J=function(){var e=$(this).data("action");i.fn.datagen.hasOwnProperty(e)&&(B(!0,e),L())},ee=function(){var e=$(this),t=e.parent();e.hasClass("disabled")||(t.find("li").removeClass("active"),e.addClass("active"),P("#sort-display",e.text()),p.sort=e.find("a").data("sort"),a.hasClass("active")&&(v=!0),L())},O=function(){P("#waveform-adshr-attack-display",d[p.waveform].a),P("#waveform-adshr-decay-display",d[p.waveform].d),P("#waveform-adshr-sustain-display",d[p.waveform].s),P("#waveform-adshr-hold-display",d[p.waveform].h),P("#waveform-adshr-release-display",d[p.waveform].r)},te=function(){$.each(["a","d","s","h","r"],function(e,t){m[t].slider("setValue",d[p.waveform][t])}),O()},E=function(e,t,a,n){return d3.scale.linear().domain([e,t]).range([a,n])},B=function(e,t){var a,n;if(e){if(i.fn.datagen.hasOwnProperty(t))for(h=i.fn.datagen[t](p.dataSize),e=(y=i.fn.datagen[t](c.max)).slice(0,p.dataSize),n=E(0,h.length-1,d3.min(e),d3.max(e)),a=0;a<h.length;a++)y[a]=Math.round(n(h[a]))}else for(h=y.slice(0,p.dataSize),n=E(d3.min(h),d3.max(h),0,h.length-1),a=0;a<h.length;a++)h[a]=Math.round(n(y[a]));f.base.setData(k()),H()},T=function(e){var e=$(e),t="id_"+(new Date).getTime();e.empty().append('<div class="js-editor" id="'+t+'"></div>'),(o=ace.edit(t)).setTheme("ace/theme/monokai"),o.getSession().setMode("ace/mode/javascript"),o.getSession().on("changeAnnotation",function(){for(var e,t=o.getSession().getAnnotations(),a=[],n=!1,r=0;r<t.length;r++)"'AS' is not defined."===(e=t[r]).text?n=!0:a.push(e);n&&o.getSession().setAnnotations(a)})},ae=function(){var e=$("#modal-midi-export");$("#midi-export-name").attr("placeholder","AudioSort_"+(new Date).getTime()).val(""),A.MidiExport.populateChannels("#midi-export-channel"),A.MidiExport.populateInstruments("#midi-export-instrument"),$("#midi-export-btn").attr("data-midi-export",$(this).data("midiExport")),e.modal()},ne=function(){var e=$("#midi-export-btn").attr("data-midi-export"),t=$("#midi-export-name"),a=$.trim(t.val());""===a&&(a=t.attr("placeholder")),a+=".mid",f.hasOwnProperty(e)&&(t=$.map(f[e].getMidiBytes(p.tempo,$("#midi-export-channel").val(),$("#midi-export-instrument").val()).split(""),function(e){return e.charCodeAt(0)}),e=new Blob([new Uint8Array(t)],{type:"audio/midi"}),saveAs(e,a))},re=function(){var e=$("#modal-sort"),t=i.sort[p.sort];e.find(".sort-name").text(t.display),e.find(".nav-tabs a:first").tab("show"),e.find("#sort-info-display").html(t.display||"&nbsp;"),e.find("#sort-info-stable").html(t.stable?"Yes":"No"),e.find("#sort-info-best").html(t.best||"&nbsp;"),e.find("#sort-info-average").html(t.average||"&nbsp;"),e.find("#sort-info-worst").html(t.worst||"&nbsp;"),e.find("#sort-info-memory").html(t.memory||"&nbsp;"),e.find("#sort-info-method").html(t.method||"&nbsp;"),T("#sort-algorithm"),t=(t=$.trim(t.toString()).split("\n")).splice(1,t.length-2).join("\n"),t=js_beautify(t,{indent_size:1,indent_char:"\t"}),o.setValue(t),o.clearSelection(),e.modal()},oe=function(){var e=$(this).data("visualization");f.sort.setVisualization(e)},ie=function(){i.sort[p.sort]=new s(o.getValue()),$("#modal-sort").modal("hide")},se=function(){var e=$("#new-sort-name").val(),t=e.replace(/[^a-zA-Z]/gi,"")+"_id_"+(new Date).getTime();$.trim(e).length&&(i.sort[t]=new s(o.getValue()),i.sort[t].display=e,i.sort[t].stable=!0,i.sort[t].best="",i.sort[t].average="",i.sort[t].worst="",i.sort[t].memory="",i.sort[t].method=""),$("#modal-add-algorithm").modal("hide"),b("#sort-options")},le=function(){var e=$("#modal-add-algorithm");e.find("#new-sort-name").val(""),T("#new-sort-algorithm"),e.modal()},G=function(e,t){"play"!==t&&"reverse"!==t&&"stop"!==t||e.stop()},ue=function(){f.base=A.Player.create("#base-section",{env:void 0,pluck:void 0,isLooping:!0,hasMarkers:!1,allowHover:!0,allowClick:!0,onClick:function(e,t){h[e]=t,y[e]=E(0,h.length-1,0,y.length-1)(t),f.base.setData(k()),clearTimeout(S),S=setTimeout(L,250)},onPlayerButtonClickCallback:function(e){G(f.sort,e.action)}}),f.sort=A.Player.create("#sort-section",{env:void 0,pluck:void 0,isLooping:!0,hasMarkers:!0,onPlayerButtonClickCallback:function(e){G(f.base,e.action)}})},ce=function(){return sc.ScaleInfo.names().sort(function(e,t){var a=0,e=sc.ScaleInfo.at(e),t=sc.ScaleInfo.at(t);return a=0===(a=e.pitchesPerOctave()-t.pitchesPerOctave())&&0===(a=e.degrees().length-t.degrees().length)?e.name.localeCompare(t.name):a})},pe=function(e){var a,n,r,o,i,s,t=$(e),l="",e=ce();$.each(e,function(e,t){r=sc.ScaleInfo.at(t),o=r.pitchesPerOctave(),i=r.degrees().length,(a=o+"_"+i)!==n&&(n=a,s=$("<li />").addClass("disabled").wrapInner($('<a href="javascript:void(0);"></a>').text("Octave: "+o+" / Notes: "+i)),l+=s.wrap("<div />").parent().html()),s=$("<li />").attr("data-scale",t).wrapInner($('<a href="javascript:void(0);"></a>').text(r.name)),l+=s.wrap("<div />").parent().html()}),t.append(l),t.on("click","li",function(){var e=$(this);e.hasClass("disabled")||(t.find("li").removeClass("active"),e.addClass("active"),p.scale=e.data("scale"),P("#scale-display",e.text()),H())})},de=function(e){for(var t,a,n="",r=$(e),o="",i=0;i<A.instruments.length;i++)n!==(t=A.instruments[i]).group&&(n=t.group,o+=(a=$("<li />").addClass("disabled").wrapInner($('<a href="javascript:void(0);"></a>').text(t.group))).wrap("<div />").parent().html()),a=$("<li />").attr("data-soundfont",t.val).wrapInner($('<a href="javascript:void(0);"></a>').text(i+": "+t.name)),p.soundfont===i&&a.addClass("active"),o+=a.wrap("<div />").parent().html();r.append(o),r.on("click","li",function(){var e=$(this);e.hasClass("disabled")||(r.find("li").removeClass("active"),e.addClass("active"),p.soundfont=e.data("soundfont"),timbre.soundfont.setInstrument(p.soundfont),P("#soundfont-display",e.text()),P("#audio-type-display",e.text()),H())})},H=function(){var e,t,a=[];if("soundfont"===p.audioType){for(e=0;e<h.length;e++)t=A.Helper.getMidiNumber(h[e]),-1===a.indexOf(t)&&0<=t&&t<128&&a.push(t);timbre.soundfont.preload(a)}},I=function(){var a=!1,e=$(this),t=e.attr("data-list-id"),t=$("#"+t+" li"),e=$.trim(e.val()),n=new RegExp(e,"i");""===e?t.show():$.each(t.get().reverse(),function(e,t){t=$(t);t.hasClass("disabled")?(t.css("display",a?"block":"none"),a=!1):n.test(t.text())?(t.show(),a=!0):t.hide()})},z=function(e){var t=f.sort.isPlaying();e.data.key===n&&(f.sort.setData(e.data.frames||[]),f.sort.goToFirst(),(t||v)&&X()),v=!1},me=function(e){console.log(e)},L=function(){n=(new Date).getTime(),"undefined"==typeof Worker?(AS.init(h,n),i.sort[p.sort](),z({data:{key:n,frames:AS.end(n)}})):(null!==e&&(e.removeEventListener("message",z,!1),e.removeEventListener("error",me,!1),e.terminate()),(e=new Worker(w)).addEventListener("message",z,!1),e.addEventListener("error",me,!1),e.postMessage({key:n,fn:i.sort[p.sort].toString(),arr:h}))};r.getSelected=function(e,t){return p.hasOwnProperty(e)?p[e]:t},r.getSelectedWaveformInfo=function(){return d[p.waveform]},r.getTempoString=function(){return"bpm"+(parseFloat(p.tempo)||l)+" l16"},r.init=function(e){"string"==typeof e&&(w=e),timbre.envmobile&&timbre.setup({samplerate:.5*timbre.samplerate}),b("#sort-options"),q(),ue(),B(!0,"randomUnique"),pe("#scale-options"),P("#scale-display",$('#scale-options li[data-scale="'+p.scale+'"]').text()),$("#scale-filter").on("keyup",I).on("focus",function(){$(this).val(""),$("#scale-options li").show()}),de("#soundfont-options"),P("#soundfont-display",$('#soundfont-options li[data-soundfont="'+p.soundfont+'"]').text()),$("#soundfont-filter").on("keyup",I).on("focus",function(){$(this).val(""),$("#soundfont-options li").show()}),A.Helper.createSlider("#volume-container",t,Y),A.Helper.createSlider("#tempo-container",l,K),A.Helper.createSlider("#center-note-container",u,Q),A.Helper.createSlider("#data-size-container",c,Z),m.a=A.Helper.createSlider("#waveform-adshr-attack-container",{value:d[p.waveform].a,min:10,max:500,step:5},M),m.d=A.Helper.createSlider("#waveform-adshr-decay-container",{value:d[p.waveform].d,min:10,max:2e3,step:5},M),m.s=A.Helper.createSlider("#waveform-adshr-sustain-container",{value:d[p.waveform].s,min:0,max:1,step:.01},M),m.h=A.Helper.createSlider("#waveform-adshr-hold-container",{value:d[p.waveform].h,min:10,max:3e3,step:5},M),m.r=A.Helper.createSlider("#waveform-adshr-release-container",{value:d[p.waveform].r,min:10,max:3e3,step:5},M),a=$("#sort-autoplay"),$("#audio-type-container .btn").on("click",_),$("#audio-type-tab-link").on("click",U),$('#audio-type-container .btn[data-audio-type="'+p.audioType+'"]').click(),$("#waveform .btn-group .btn").on("click",V),$("span[data-midi-export]").on("click",ae),$("#midi-export-btn").on("click",ne),$("#modal-sort-open").on("click",re),$("#add-algorithm-btn").on("click",le),$("#save-algorithm-edit").on("click",ie),$("#save-algorithm-new").on("click",se),$("#base-buttons").on("click",".btn",J),$("#sort-options").on("click","li",ee),$(".sort-visualization").on("click",oe),$("#sort-options [data-sort="+p.sort+"]").click(),f.base.drawWaveformCanvases(),P("#volume-display",p.volume),P("#tempo-display",p.tempo),P("#center-note-display",p.centerNote,x),P("#data-size-display",p.dataSize)},i.A.Sort=r}(this),function(e){"use strict";e.A.instruments=[{val:0,name:"Acoustic Grand Piano",group:"Piano"},{val:1,name:"Bright Acoustic Piano",group:"Piano"},{val:2,name:"Electric Grand Piano",group:"Piano"},{val:3,name:"Honky-tonk Piano",group:"Piano"},{val:4,name:"Electric Piano 1",group:"Piano"},{val:5,name:"Electric Piano 2",group:"Piano"},{val:6,name:"Harpsichord",group:"Piano"},{val:7,name:"Clavinet",group:"Piano"},{val:8,name:"Celesta",group:"Chromatic Percussion"},{val:9,name:"Glockenspiel",group:"Chromatic Percussion"},{val:10,name:"Music Box",group:"Chromatic Percussion"},{val:11,name:"Vibraphone",group:"Chromatic Percussion"},{val:12,name:"Marimba",group:"Chromatic Percussion"},{val:13,name:"Xylophone",group:"Chromatic Percussion"},{val:14,name:"Tubular Bells",group:"Chromatic Percussion"},{val:15,name:"Dulcimer",group:"Chromatic Percussion"},{val:16,name:"Drawbar Organ",group:"Organ"},{val:17,name:"Percussive Organ",group:"Organ"},{val:18,name:"Rock Organ",group:"Organ"},{val:19,name:"Church Organ",group:"Organ"},{val:20,name:"Reed Organ",group:"Organ"},{val:21,name:"Accordion",group:"Organ"},{val:22,name:"Harmonica",group:"Organ"},{val:23,name:"Tango Accordion",group:"Organ"},{val:24,name:"Acoustic Guitar (nylon)",group:"Guitar"},{val:25,name:"Acoustic Guitar (steel)",group:"Guitar"},{val:26,name:"Electric Guitar (jazz)",group:"Guitar"},{val:27,name:"Electric Guitar (clean)",group:"Guitar"},{val:28,name:"Electric Guitar (muted)",group:"Guitar"},{val:29,name:"Overdriven Guitar",group:"Guitar"},{val:30,name:"Distortion Guitar",group:"Guitar"},{val:31,name:"Guitar Harmonics",group:"Guitar"},{val:32,name:"Acoustic Bass",group:"Bass"},{val:33,name:"Electric Bass (finger)",group:"Bass"},{val:34,name:"Electric Bass (pick)",group:"Bass"},{val:35,name:"Fretless Bass",group:"Bass"},{val:36,name:"Slap Bass 1",group:"Bass"},{val:37,name:"Slap Bass 2",group:"Bass"},{val:38,name:"Synth Bass 1",group:"Bass"},{val:39,name:"Synth Bass 2",group:"Bass"},{val:40,name:"Violin",group:"Strings"},{val:41,name:"Viola",group:"Strings"},{val:42,name:"Cello",group:"Strings"},{val:43,name:"Contrabass",group:"Strings"},{val:44,name:"Tremolo Strings",group:"Strings"},{val:45,name:"Pizzicato Strings",group:"Strings"},{val:46,name:"Orchestral Harp",group:"Strings"},{val:47,name:"Timpani",group:"Strings"},{val:48,name:"String Ensemble 1",group:"Ensemble"},{val:49,name:"String Ensemble 2",group:"Ensemble"},{val:50,name:"Synth Strings 1",group:"Ensemble"},{val:51,name:"Synth Strings 2",group:"Ensemble"},{val:52,name:"Choir Aahs",group:"Ensemble"},{val:53,name:"Voice Oohs",group:"Ensemble"},{val:54,name:"Synth Choir",group:"Ensemble"},{val:55,name:"Orchestra Hit",group:"Ensemble"},{val:56,name:"Trumpet",group:"Brass"},{val:57,name:"Trombone",group:"Brass"},{val:58,name:"Tuba",group:"Brass"},{val:59,name:"Muted Trumpet",group:"Brass"},{val:60,name:"French Horn",group:"Brass"},{val:61,name:"Brass Section",group:"Brass"},{val:62,name:"Synth Brass 1",group:"Brass"},{val:63,name:"Synth Brass 2",group:"Brass"},{val:64,name:"Soprano Sax",group:"Reed"},{val:65,name:"Alto Sax",group:"Reed"},{val:66,name:"Tenor Sax",group:"Reed"},{val:67,name:"Baritone Sax",group:"Reed"},{val:68,name:"Oboe",group:"Reed"},{val:69,name:"English Horn",group:"Reed"},{val:70,name:"Bassoon",group:"Reed"},{val:71,name:"Clarinet",group:"Reed"},{val:72,name:"Piccolo",group:"Pipe"},{val:73,name:"Flute",group:"Pipe"},{val:74,name:"Recorder",group:"Pipe"},{val:75,name:"Pan Flute",group:"Pipe"},{val:76,name:"Blown bottle",group:"Pipe"},{val:77,name:"Shakuhachi",group:"Pipe"},{val:78,name:"Whistle",group:"Pipe"},{val:79,name:"Ocarina",group:"Pipe"},{val:80,name:"Lead 1 (square)",group:"Synth Lead"},{val:81,name:"Lead 2 (sawtooth)",group:"Synth Lead"},{val:82,name:"Lead 3 (calliope)",group:"Synth Lead"},{val:83,name:"Lead 4 (chiff)",group:"Synth Lead"},{val:84,name:"Lead 5 (charang)",group:"Synth Lead"},{val:85,name:"Lead 6 (voice)",group:"Synth Lead"},{val:86,name:"Lead 7 (fifths)",group:"Synth Lead"},{val:87,name:"Lead 8 (bass + lead)",group:"Synth Lead"},{val:88,name:"Pad 1 (new age)",group:"Synth Pad"},{val:89,name:"Pad 2 (warm)",group:"Synth Pad"},{val:90,name:"Pad 3 (polysynth)",group:"Synth Pad"},{val:91,name:"Pad 4 (choir)",group:"Synth Pad"},{val:92,name:"Pad 5 (bowed)",group:"Synth Pad"},{val:93,name:"Pad 6 (metallic)",group:"Synth Pad"},{val:94,name:"Pad 7 (halo)",group:"Synth Pad"},{val:95,name:"Pad 8 (sweep)",group:"Synth Pad"},{val:96,name:"FX 1 (rain)",group:"Synth Effects"},{val:97,name:"FX 2 (soundtrack)",group:"Synth Effects"},{val:98,name:"FX 3 (crystal)",group:"Synth Effects"},{val:99,name:"FX 4 (atmosphere)",group:"Synth Effects"},{val:100,name:"FX 5 (brightness)",group:"Synth Effects"},{val:101,name:"FX 6 (goblins)",group:"Synth Effects"},{val:102,name:"FX 7 (echoes)",group:"Synth Effects"},{val:103,name:"FX 8 (sci-fi)",group:"Synth Effects"},{val:104,name:"Sitar",group:"Ethnic"},{val:105,name:"Banjo",group:"Ethnic"},{val:106,name:"Shamisen",group:"Ethnic"},{val:107,name:"Koto",group:"Ethnic"},{val:108,name:"Kalimba",group:"Ethnic"},{val:109,name:"Bagpipe",group:"Ethnic"},{val:110,name:"Fiddle",group:"Ethnic"},{val:111,name:"Shanai",group:"Ethnic"},{val:112,name:"Tinkle Bell",group:"Percussive"},{val:113,name:"Agogo",group:"Percussive"},{val:114,name:"Steel Drums",group:"Percussive"},{val:115,name:"Woodblock",group:"Percussive"},{val:116,name:"Taiko Drum",group:"Percussive"},{val:117,name:"Melodic Tom",group:"Percussive"},{val:118,name:"Synth Drum",group:"Percussive"},{val:119,name:"Reverse Cymbal",group:"Percussive"},{val:120,name:"Guitar Fret Noise",group:"Sound effects"},{val:121,name:"Breath Noise",group:"Sound effects"},{val:122,name:"Seashore",group:"Sound effects"},{val:123,name:"Bird Tweet",group:"Sound effects"},{val:124,name:"Telephone Ring",group:"Sound effects"},{val:125,name:"Helicopter",group:"Sound effects"},{val:126,name:"Applause",group:"Sound effects"},{val:127,name:"Gunshot",group:"Sound effects"}]}(this);